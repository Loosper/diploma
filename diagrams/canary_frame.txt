 protected frame
┌───────────────┐◀───────┐
│    param 3    │        │
├───────────────┤        │
│    param 2    │        │
├───────────────┤        │
│   saved rip   │   rbp  │
├───────────────┤◀────── │
│   saved rbp   │────────┘
├───────────────┤
│    canary     │
├───────────────┤
│  buffer[end]  │
├───────────────┤
│       .       │
│       .       │
│       .       │
├───────────────┤
│  buffer[end]  │
├───────────────┤
│     var 2     │   rsp
└───────────────┘◀──────